<?php
// $Id$
/**
	* @file
	* A custom module
	*/
//drupal_flush_all_caches();	
/** 
 * Implement hook_menu(). 
 */ 
function cals_forms_menu() { 
	$items = array();
 
	return $items;
}	

/**
 * Checks if user has access to permission and node type is organization
 *
 * @param $node
 *   A node object to be checked.
 * @return
 *   TRUE if user can make conversions using this type, FALSE otherwise.
 */
function cals_forms_check_accessxxxxx($node) {
  $access = (user_access('administer ILS Auth') || $node->type == 'organization' ) ? TRUE : FALSE;
  return $access;
}
/**
 * Implements hook_permission().
 */
function cals_forms_permissionxxxx() {
  $types = node_type_get_types();
  $permissions = array(
    'administer ILS Auth' => array(
      'title' => t('administer ILS Authentication'),
      'description' => t('Grants full permissions for admininstrating ILS Authentication.'),
    ),
  );
  
  return $permissions;
}

 

/* ----------- The forms ------------ */
/**
 * Implements hook_form_alter().
 */
function cals_forms_form_alter(&$form, &$form_state, $form_id) {

	switch($form_id) {
		case "post_node_form":
			// do we want a multistep form? Probably not ... but if we do, 
			// implement a new form_state var to track
			// if (!isset($form_state['stage'])) $form_state['stage'] = 'create_new_node';
			//$form['#submit'][] = '_cals_forms_org_submit'; //doesn't seem to work.
 			//$form['actions']['submit']['#submit'][] = '_cals_forms_org_submit';
			break;
		
	}

}

 
 
/**
 * @todo Please document this function.
 */
 
/**
 * @todo Please document this function.
 */

/**
 * implementation hook_menu_alter();
 * @param unknown_type $items

function cals_forms_menu_alter(&$items) {

  // Change node clone menu item to a tab instead of an action
  $items['node/%node/clone']['type'] = MENU_LOCAL_TASK;
  
}
 */

/**
 * Implements hook_help().
 */

function cals_forms_help($path, $arg) {
	if ($path == 'admin/help#cals') {
		global $user;
		$values = array('%user' => $user->name); 

		return t('A demo module for the CALS site. Thanks for visiting %user', $values);
	}
}
